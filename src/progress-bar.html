<link rel="import" href="../bower_components/paper-progress/paper-progress.html">
<link rel="import" href="../bower_components/iron-signals/iron-signals.html">


<dom-module name="progress-bar">
<template>
  <style>
  #progressbar {
    display: block;
    width: 100%;
  }
  </style>
  <style is="custom-style">
  :root {
      --paper-progress-transition-timing-function: ease;
      --paper-progress-transition-transition-delay: 0s;
  }
  </style>
  <paper-progress id="progressbar" class="transiting" value="{{position}}" id="progressbar" step="5" max="1000"></paper-progress>
</template>
<script>
(function() {
  Polymer({
    is: 'progress-bar',
    properties: {
        progress: String
    },
    doProgress: function(command) {
      if (this.progress == command)
        return;
      this.progress = command;
      this.async(this.waitProgress.bind(this));
      this.async(this._doProgress.bind(this), 100);
    },
    _doProgress: function() {
      switch (this.progress) {
        case "start":
          this.startProgress();
          break;
        case "finish":
          this.finishProgress();
          break;
        case "error":
          this.errorProgress();
          break;
      }
    },
    waitProgress: function() {
      this.position = 0;
    //   this.position = this.$.progressbar.value;
      this.customStyle['--paper-progress-active-color'] = "#00a05a";
      this.toggleAttribute('indeterminate', false, this.$.progressbar);
      this.updateStyles();
    },
    startProgress: function() {
      this.position = 1000;
      this.customStyle['--paper-progress-active-color'] = "#00a05a";
      this.customStyle['--paper-progress-transition-duration'] = "5s";
      this.toggleAttribute('indeterminate', true, this.$.progressbar);
      this.updateStyles();
    },
    ready: function() {
      this.progress = null;
      this.doProgress("wait");
    },
    finishProgress: function() {
      this.customStyle['--paper-progress-transition-duration'] = "0.5s";
      this.customStyle['--paper-progress-active-color'] = "#005aa0";
      this.toggleAttribute('indeterminate', false, this.$.progressbar);
      this.updateStyles();
      this.position = 1000;
    },
    errorProgress: function() {
      this.customStyle['--paper-progress-transition-duration'] = "0.5s";
      this.customStyle['--paper-progress-active-color'] = "#a05a5a";
      this.toggleAttribute('indeterminate', false, this.$.progressbar);
      this.updateStyles();
    },
    getProgress: function() {
      return this.progress;
    }
  });
})();
</script>
</dom-module>
